name: Run Spectral on Pull Requests


on: pull_request


jobs:
  build:
    name: Run Spectral
    runs-on: ubuntu-latest
    steps:
      # Check out the repository
      - uses: actions/checkout@v2
     
      # Add comment to PR
      - name: Comment a pull_request
        uses: mshick/add-pr-comment@v2
        with:
          message: "Thanks for your contribution. The .json file will be checked now with Spectral."
          repo-token: ${{ secrets.GITHUB_TOKEN }}        
     
      # Get the name of changed files
      - name: Get changed files
        id: changed-files
        uses: tj-actions/changed-files@v38.1.3
        with:
          files: \.json$        


      # Run Spectral on changed files
      - uses: stoplightio/spectral-action@v0.8.10
        with:
          file_glob: ${{ steps.changed-files.outputs.all_modified_files }}